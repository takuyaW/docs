バックエンドの管理
==================

\[ Monaca バックエンド管理 \] パネル上で操作できる項目を、次に記します。

-   backend\_control\_panel\_user\_management
-   backend\_control\_panel\_collection\_management
-   backend\_control\_panel\_mail\_template\_management
-   プッシュ通知 &lt;push\_notification\_manual&gt;

ユーザー管理
------------

バックエンド管理パネル上では、ユーザー関連のデータを手動で操作できます。

### ユーザーの新規追加

1.  バックエンド管理パネルから、 ユーザー --&gt; ユーザー追加
    を選択します。

    {{<img src="/images/backend/control_operations/4.png">}}

2.  ユーザー情報 ( ユーザー名、パスワード、プロパティー )
    を入力して、追加する ボタンをクリックします。

    {{<img src="/images/backend/control_operations/5.png">}}
>
> <div class="admonition note">
>
> 正しい JSON
> の記法を使用して、プロパティーを記述してください。プロパティーの記述が正しくない場合、エラーが出力されます。
>
> </div>

3.  新規ユーザーの追加後、\[ ユーザー \]
    タブ上に新規のレコードが表示されます。

> ![](images/backend/control_operations/6.png){width="600px"}

### ユーザーのプロパティーの更新

1.  \[ ユーザー \]
    タブ上で、編集対象のユーザーレコードをクリックすると、プロパティーの内容が表示されます。

> ![](images/backend/control_operations/7.png){width="400px"}

2.  ユーザーのプロパティーを更新します。更新時には、正しい JSON
    の記法を使用します。ここでは、ユーザーの 「 age 」 を 27 から 25
    に変更し、加えて、「 job 」 プロパティーを追加してみましょう。

> ![](images/backend/control_operations/8.png){width="400px"}
>
> <div class="admonition note">
>
> プロパティーの追加と更新はできますが、削除はできません (
> 削除後、更新すると再び表示されます
> )。また、システム側で使用するプロパティーは、原則、更新できません ( 「
> \_ 」 で始まるプロパティーがシステムプロパティーです。たとえば、「
> \_createdAt 」、「 \_id 」 などがあります )。ただし、「 \_username 」
> だけは、更新することができます。
>
> </div>

### ユーザーの削除

1.  \[ ユーザー \]
    タブ上で、削除するユーザーのレコードにチェックを入れます (
    複数選択可 )。
2.  ユーザー削除 をクリックします。

> ![](images/backend/control_operations/9.png){width="600px"}

<div class="admonition warning">

データをいったん削除してしまうと復旧できません。データを削除する場合には、ご注意ください。

</div>

コレクション管理
----------------

「 コレクション 」
とはデータの集合体を意味します。データに対するパーミッション ( 権限 )
をユーザー別に設定できるので、アプリ内で使うデータを適切に管理できます。設定可能なパーミッションには、\*作成\*、\*アクセス許可\*、\*編集\*、\*削除\*、\*読み取り専用\*
の 5 種類があります。

ここでは、コレクションの管理方法を解説します。例として、\*\_id\*、\*name\*
( 名前 )、\*color\* ( 色 )、\*taste\* ( 味 )
を、プロパティーの項目として使用します。データの行を
*コレクションアイテム* と呼びます ( 例 : lemon、yellow、sour の行
)。コレクションアイテムの集合体を、 *コレクション*
と呼びます。データベースの用語を借りると、コレクションはテーブル、コレクションアイテムはレコードとなります。

コレクションアイテムには、アンダースコア ( 「 \_ 」 )
で始まる、システムプロパティーが複数あります。たとえば、 `_id`
は、システムプロパティーであり、コレクションアイテムを識別する一意の ID
です。

  \_id           name         color        taste
  -------------- ------------ ------------ ----------------
  00001abc       apple        red          sweet
  00002def       orange       orange       sour-sweet
  00003ghi       lemon        yellow       sour

### コレクションの新規作成

1.  バックエンド管理パネルから、オプションメニュー
    アイコンをクリックして、コレクションの作成... を選択します。

> ![](images/backend/control_operations/10.png){width="350px"}

2.  \[ コレクションの作成 \]
    ダイアログが表示されます。コレクションに関する情報を入力して、追加する
    ボタンをクリックします。

> -   コレクション名 : コレクションの名前を入力します。
> -   コレクションのセキュリティ :
>     JavaScript からのアイテム追加を許可する
>     にチェックを入れた場合は、アプリからのコレクションへのデータ挿入を許可します。
> -   新規アイテムのパーミッション初期値 :　Read または/および Write
>     にチェックを入れ、新規アイテムに対して、読み取り または/および
>     書き込みパーミッション ( 権限 ) を与えるか選択します (
>     対象はすべてのユーザーとなります )。
>
> ![](images/backend/control_operations/11.png){width="400px"}

### コレクションの削除

1.  バックエンド管理パネル上で、削除するコレクションを右クリックして、コレクションを削除
    を選択します。

> ![](images/backend/control_operations/12.png){width="300px"}

2.  削除する をクリックすると、確認ダイアログが表示されます。はい
    をクリックして、削除します。

### コレクションアイテムの新規追加

1.  バックエンド管理パネル上で、アイテムを追加するコレクションを選択します。次に、アイテム追加
    をクリックします。

> ![](images/backend/control_operations/13.png){width="600px"}

2.  コレクションアイテムのデータを、JSON 形式で入力して、追加する
    ボタンをクリックします。

> ![](images/backend/control_operations/14.png){width="400px"}
>
> <div class="admonition note">
>
> 正しい JSON
> の記法を使用して、プロパティーを記述してください。プロパティーの記述が正しくない場合、エラーが出力されます。
>
> </div>

3.  アイテムの追加後、\[ コレクション名 \]
    タブ上に追加したアイテムが表示されます。

> ![](images/backend/control_operations/15.png){width="600px"}

#### コレクションアイテムの項目 ( 列 ) の表示・非表示

コレクションアイテムの表示項目 ( 列 )
には、デフォルトで、Oid、オーナーユーザ、作成日時、更新日時、パーミッションがあります。これらの項目は、表示・非表示にできます。

1.  \[ コレクション名 \] タブ上で、詳細メニュー --&gt; 列の追加
    を選択します。

> ![](images/backend/control_operations/16.png){width="600px"}

2.  表示する項目 ( 列 ) を個別に追加していきます。

> ![](images/backend/control_operations/17.png){width="400px"}

3.  項目の表示位置は、手動で左右に変更できます。

> ![](images/backend/control_operations/18.png){width="600px"}

4.  項目を非表示にする場合、対象の項目上にカーソルを移動させ、表示されたドロップダウン
    アイコンから この列を表示しない を選択します (
    システムプロパティー以外が対象 )。

> ![](images/backend/control_operations/19.png){width="600px"}

### コレクションアイテムの更新

1.  \[ コレクション名 \]
    タブ上で、更新するアイテムを選択します。次に、アイテムのプロパティーが表示されます。
2.  正しい JSON
    の記法を使用して、アイテムのプロパティーを更新します。ここでは、アイテムの
    name と taste を、それぞれ変更してみます ( name : `lemon` から
    `banana` へ、taste : `sour` から `sweet` へ )。

> ![](images/backend/control_operations/20.png){width="500px"}

<div class="admonition note">

プロパティーの追加と更新はできますが、削除はできません (
削除後、更新すると再び表示されます
)。また、システム側で使用するプロパティーは、更新できません ( 「 \_ 」
で始まるプロパティーがシステムプロパティーです。たとえば、「 \_createdAt
」、「 \_id 」 などがあります )。

</div>

### コレクションの削除 Item

1.  \[ コレクション名 \]
    タブ上で、削除するアイテムにチェックを入れます。
2.  アイテム削除 をクリックします。

> ![](images/backend/control_operations/21.png){width="600px"}

3.  確認用のダイアログが表示されるので、はい をクリックします。

<div class="admonition warning">

データをいったん削除してしまうと復旧できません。データを削除する場合には、ご注意ください。

</div>

### コレクションアイテムに付与したパーミッションの変更

コレクションアイテム毎、ユーザー毎に、パーミッションは変更できます。

2 種類のユーザーがいます。

1.  「 所有者 」
    は、コレクションを作成したユーザーを指します。所有者には、read (
    読み取り )・write ( 書き込み ) のパーミッションが常に付与されます。
2.  「 public 」 は、「 現在ログインしていない、すべてのユーザー 」
    を指します。デフォルトでは、これらのユーザーには、どちらのパーミッション
    ( read と write ) も付与されていません。

ユーザーのパーミッションをコレクションアイテム毎に変更する方法を、次に記します。

1.  \[ コレクション名 \] タブ上で、対象のアイテムに表示された
    パーミッション ( 南京錠 ) アイコンをクリックします。

> ![](images/backend/control_operations/22.png){width="600px"}

2.  \[ パーミッション設定 \]
    ダイアログが表示されます。ここでは、このコレクションアイテムに対するパーミッションを、ユーザー毎に変更できます。複数のユーザーが存在する場合には、ユーザーの一覧がコンボボックス上に表示され、ユーザーを選択できます。ユーザーの選択後、read
    または write にチェックを入れ、追加する
    ボタンをクリックします。これで、新規に設定したパーミッションが、選択したユーザーに適用されます。

> ![](images/backend/control_operations/23.png){width="400px"}

3.  保存する ボタンをクリックします。

メールテンプレートの管理
------------------------

アプリのユーザー宛に送信する電子メールのテンプレートを作成・編集できます。

1.  バックエンド管理パネル上で、メールテンプレート を選択します。
2.  メールテンプレートの作成画面が表示されます。ここで、メールテンプレートの編集・追加を行えます。

> ![](images/backend/control_operations/24.png){width="500px"}

3.  テンプレートの作成・編集後、適用 ボタンをクリックします。

<div class="admonition note">

メールテンプレートの作成・編集を行えるのは、Monaca クラウド IDE
上だけです。

</div>
